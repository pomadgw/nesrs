LDA:
  cases:
    - description: IMM
      code:
        - 0xa9
        - 0x55
      expected:
        read_from: a
        value: 0x55
        cycles: 2
    - description: IMM
      code:
        - 0xa9
        - 0x00
      expected:
        read_from: a
        value: 0x00
        cycles: 2
        check_flag:
          z: true
    - description: IMM
      code:
        - 0xa9
        - 0x80
      expected:
        read_from: a
        value: 0x80
        cycles: 2
        check_flag:
          n: true
    - description: ABS
      code:
        - 0xad
        - 0x55
        - 0x54
      init_memories:
        - start: 0x5455
          values:
            - 0xaa
      expected:
        read_from: a
        target_address: 0x5455
        value: 0xaa
        cycles: 4
    - description: ABX
      code:
        - 0xbd
        - 0x55
        - 0x54
      cpu:
        x: 0x10
      init_memories:
        - start: 0x5465
          values:
            - 0xaa
      expected:
        read_from: a
        target_address: 0x5465
        value: 0xaa
        cycles: 4
    - description: ABX (cross page)
      code:
        - 0xbd
        - 0xf5
        - 0x54
      cpu:
        x: 0x10
      init_memories:
        - start: 0x5505
          values:
            - 0xaa
      expected:
        read_from: a
        target_address: 0x5505
        value: 0xaa
        cycles: 5
    - description: ABY
      code:
        - 0xb9
        - 0x55
        - 0x54
      cpu:
        y: 0x10
      init_memories:
        - start: 0x5465
          values:
            - 0xaa
      expected:
        read_from: a
        target_address: 0x5465
        value: 0xaa
        cycles: 4
    - description: ABY (cross page)
      code:
        - 0xb9
        - 0xf5
        - 0x54
      cpu:
        y: 0x10
      init_memories:
        - start: 0x5505
          values:
            - 0xaa
      expected:
        read_from: a
        target_address: 0x5505
        value: 0xaa
        cycles: 5
    - description: ZP0
      code:
        - 0xa5
        - 0x55
      init_memories:
        - start: 0x55
          values:
            - 0xaa
      expected:
        read_from: a
        target_address: 0x55
        value: 0xaa
        cycles: 3
    - description: ZPX
      code:
        - 0xb5
        - 0x55
      cpu:
        x: 0x10
      init_memories:
        - start: 0x65
          values:
            - 0xaa
      expected:
        read_from: a
        target_address: 0x65
        value: 0xaa
        cycles: 4
    - description: IZX
      code:
        - 0xa1
        - 0x55
      cpu:
        x: 0x10
      init_memories:
        - start: 0x65
          values:
            - 0x50
            - 0xc0
        - start: 0xc050
          values:
            - 0xaa
      expected:
        read_from: a
        target_address: 0xc050
        value: 0xaa
        cycles: 6
    - description: IZX (wrap up)
      code:
        - 0xa1
        - 0x55
      cpu:
        x: 0xff
      expected:
        read_from: a
        target_address: 0xc050
        value: 0xaa
        cycles: 6
      init_memories:
        - start: 0x54
          values:
            - 0x50
            - 0xc0
        - start: 0xc050
          values:
            - 0xaa
    - description: IZY
      code:
        - 0xb1
        - 0x55
      cpu:
        y: 0x10
      init_memories:
        - start: 0x55
          values:
            - 0x50
            - 0xc0
        - start: 0xc060
          values:
            - 0xaa
      expected:
        read_from: a
        target_address: 0xc060
        value: 0xaa
        cycles: 5
    - description: IZY (cross page)
      code:
        - 0xb1
        - 0x55
      cpu:
        y: 0xff
      init_memories:
        - start: 0x55
          values:
            - 0x01
            - 0xc0
        - start: 0xc100
          values:
            - 0xaa
      expected:
        read_from: a
        target_address: 0xc100
        value: 0xaa
        cycles: 6
LDX:
  cases:
    - description: IMM
      code:
        - 0xa2
        - 0x55
      expected:
        read_from: x
        value: 0x55
        cycles: 2
    - description: IMM
      code:
        - 0xa2
        - 0x00
      expected:
        read_from: x
        value: 0x00
        cycles: 2
        check_flag:
          z: true
    - description: IMM
      code:
        - 0xa2
        - 0x80
      expected:
        read_from: x
        value: 0x80
        cycles: 2
        check_flag:
          n: true
    - description: ZP0
      code:
        - 0xa6
        - 0x55
      init_memories:
        - start: 0x55
          values:
            - 0xaa
      expected:
        read_from: x
        target_address: 0x55
        value: 0xaa
        cycles: 3
    - description: ZPY
      code:
        - 0xb6
        - 0x55
      cpu:
        y: 0x10
      init_memories:
        - start: 0x65
          values:
            - 0xaa
      expected:
        read_from: x
        target_address: 0x65
        value: 0xaa
        cycles: 4
    - description: ABS
      code:
        - 0xae
        - 0x00
        - 0x55
      init_memories:
        - start: 0x5500
          values:
            - 0xaa
      expected:
        read_from: x
        target_address: 0x5500
        value: 0xaa
        cycles: 4
    - description: ABY
      code:
        - 0xbe
        - 0x00
        - 0x55
      cpu:
        y: 0x10
      init_memories:
        - start: 0x5510
          values:
            - 0xaa
      expected:
        read_from: x
        target_address: 0x5510
        value: 0xaa
        cycles: 4
    - description: ABY (cross page)
      code:
        - 0xbe
        - 0x01
        - 0x55
      cpu:
        y: 0xff
      init_memories:
        - start: 0x5600
          values:
            - 0xaa
      expected:
        read_from: x
        target_address: 0x5600
        value: 0xaa
        cycles: 5
LDY:
  cases:
    - description: IMM
      code:
        - 0xa0
        - 0x55
      expected:
        read_from: y
        value: 0x55
        cycles: 2
    - description: IMM
      code:
        - 0xa0
        - 0x00
      expected:
        read_from: y
        value: 0x00
        cycles: 2
        check_flag:
          z: true
    - description: IMM
      code:
        - 0xa0
        - 0x80
      expected:
        read_from: y
        value: 0x80
        cycles: 2
        check_flag:
          n: true
    - description: ZP0
      code:
        - 0xa4
        - 0x55
      init_memories:
        - start: 0x55
          values:
            - 0xaa
      expected:
        read_from: y
        target_address: 0x55
        value: 0xaa
        cycles: 3
    - description: ZPX
      code:
        - 0xb4
        - 0x55
      cpu:
        x: 0x10
      init_memories:
        - start: 0x65
          values:
            - 0xaa
      expected:
        read_from: y
        target_address: 0x65
        value: 0xaa
        cycles: 4
    - description: ABS
      code:
        - 0xac
        - 0x00
        - 0x55
      init_memories:
        - start: 0x5500
          values:
            - 0xaa
      expected:
        read_from: y
        target_address: 0x5500
        value: 0xaa
        cycles: 4
    - description: ABX
      code:
        - 0xbc
        - 0x00
        - 0x55
      cpu:
        x: 0x10
      init_memories:
        - start: 0x5510
          values:
            - 0xaa
      expected:
        read_from: y
        target_address: 0x5510
        value: 0xaa
        cycles: 4
    - description: ABX (cross page)
      code:
        - 0xbc
        - 0x01
        - 0x55
      cpu:
        x: 0xff
      init_memories:
        - start: 0x5600
          values:
            - 0xaa
      expected:
        read_from: y
        target_address: 0x5600
        value: 0xaa
        cycles: 5
ASL:
  cases:
    - description: ACC
      code:
        - 0x0a
      cpu:
        a: 0x01
      expected:
        read_from: a
        value: 0x02
        cycles: 2
    - description: ACC (check N)
      code:
        - 0x0a
      cpu:
        a: 0x7f
      expected:
        read_from: a
        value: 0xfe
        check_flag:
          n: true
    - description: ACC (check Z and C, carry over)
      code:
        - 0x0a
      cpu:
        a: 0x80
      expected:
        read_from: a
        value: 0x00
        check_flag:
          z: true
          c: true
    - description: ACC (check Z and C, no carry over)
      code:
        - 0x0a
      cpu:
        a: 0x00
      expected:
        read_from: a
        value: 0x00
        check_flag:
          z: true
          c: false
    - description: ABS
      code:
        - 0x0e
        - 0x00
        - 0x50
      init_memories:
        - start: 0x5000
          values:
            - 0x01
      expected:
        read_from: address
        target_address: 0x5000
        value: 0x02
        cycles: 6
    - description: ABX
      code:
        - 0x1e
        - 0x00
        - 0x50
      cpu:
        x: 0x10
      init_memories:
        - start: 0x5010
          values:
            - 0x01
      expected:
        read_from: address
        target_address: 0x5010
        value: 0x02
        cycles: 7
    - description: ZP0
      code:
        - 0x06
        - 0x00
      init_memories:
        - start: 0x00
          values:
            - 0x01
      expected:
        read_from: address
        target_address: 0x00
        value: 0x02
        cycles: 5
    - description: ZPX
      code:
        - 0x16
        - 0x00
      cpu:
        x: 0x10
      init_memories:
        - start: 0x10
          values:
            - 0x01
      expected:
        read_from: address
        target_address: 0x10
        value: 0x02
        cycles: 6

# Register Instructions
TAX:
  cases:
    - description: IMM
      code:
        - 0xaa
      cpu:
        a: 0x12
        x: 0x00
      expected:
        read_from: x
        value: 0x12
        cycles: 2
    - description: IMM (check N)
      code:
        - 0xaa
      cpu:
        a: 0x80
        x: 0x00
      expected:
        read_from: x
        value: 0x80
        check_flag:
          n: true
    - description: IMM (check Z)
      code:
        - 0xaa
      cpu:
        a: 0x00
        x: 0x10
      expected:
        read_from: x
        value: 0x00
        check_flag:
          z: true
TAY:
  cases:
    - description: IMM
      code:
        - 0xa8
      cpu:
        a: 0x12
        y: 0x00
      expected:
        read_from: y
        value: 0x12
        cycles: 2
    - description: IMM (check N)
      code:
        - 0xa8
      cpu:
        a: 0x80
        y: 0x00
      expected:
        read_from: y
        value: 0x80
        check_flag:
          n: true
    - description: IMM (check Z)
      code:
        - 0xa8
      cpu:
        a: 0x00
        y: 0x10
      expected:
        read_from: y
        value: 0x00
        check_flag:
          z: true
TXA:
  cases:
    - description: IMM
      code:
        - 0x8a
      cpu:
        a: 0x00
        x: 0x12
      expected:
        read_from: a
        value: 0x12
        cycles: 2
    - description: IMM (check N)
      code:
        - 0x8a
      cpu:
        x: 0x80
        a: 0x00
      expected:
        read_from: a
        value: 0x80
        check_flag:
          n: true
    - description: IMM (check Z)
      code:
        - 0x8a
      cpu:
        x: 0x00
        a: 0x10
      expected:
        read_from: a
        value: 0x00
        check_flag:
          z: true
TYA:
  cases:
    - description: IMM
      code:
        - 0x98
      cpu:
        y: 0x12
        a: 0x00
      expected:
        read_from: a
        value: 0x12
        cycles: 2
    - description: IMM (check N)
      code:
        - 0x98
      cpu:
        y: 0x80
        a: 0x00
      expected:
        read_from: a
        value: 0x80
        check_flag:
          n: true
    - description: IMM (check Z)
      code:
        - 0x98
      cpu:
        y: 0x00
        a: 0x10
      expected:
        read_from: a
        value: 0x00
        check_flag:
          z: true
INX:
  cases:
    - description: IMM
      code:
        - 0xe8
      cpu:
        x: 0x12
      expected:
        read_from: x
        value: 0x13
        cycles: 2
    - description: IMM (check N)
      code:
        - 0xe8
      cpu:
        x: 0x7f
      expected:
        read_from: x
        value: 0x80
        check_flag:
          n: true
    - description: IMM (check Z)
      code:
        - 0xe8
      cpu:
        x: 0xff
      expected:
        read_from: x
        value: 0x00
        check_flag:
          z: true
INY:
  cases:
    - description: IMM
      code:
        - 0xc8
      cpu:
        y: 0x12
      expected:
        read_from: y
        value: 0x13
        cycles: 2
    - description: IMM (check N)
      code:
        - 0xc8
      cpu:
        y: 0x7f
      expected:
        read_from: y
        value: 0x80
        check_flag:
          n: true
    - description: IMM (check Z)
      code:
        - 0xc8
      cpu:
        y: 0xff
      expected:
        read_from: y
        value: 0x00
        check_flag:
          z: true
DEX:
  cases:
    - description: IMM
      code:
        - 0xca
      cpu:
        x: 0x12
      expected:
        read_from: x
        value: 0x11
        cycles: 2
    - description: IMM (check N)
      code:
        - 0xca
      cpu:
        x: 0x00
      expected:
        read_from: x
        value: 0xff
        check_flag:
          n: true
    - description: IMM (check Z)
      code:
        - 0xca
      cpu:
        x: 0x01
      expected:
        read_from: x
        value: 0x00
        check_flag:
          z: true
DEY:
  cases:
    - description: IMM
      code:
        - 0x88
      cpu:
        y: 0x12
      expected:
        read_from: y
        value: 0x11
        cycles: 2
    - description: IMM (check N)
      code:
        - 0x88
      cpu:
        y: 0x00
      expected:
        read_from: y
        value: 0xff
        check_flag:
          n: true
    - description: IMM (check Z)
      code:
        - 0x88
      cpu:
        y: 0x01
      expected:
        read_from: y
        value: 0x00
        check_flag:
          z: true
STA:
  cases:
    - description: ZP0
      code:
        - 0x85
        - 0x3f
      cpu:
        a: 0x55
      expected:
        read_from: address
        target_address: 0x3f
        value: 0x55
        cycles: 3
    - description: ZPX
      code:
        - 0x95
        - 0x3f
      cpu:
        a: 0x55
        x: 0x01
      expected:
        read_from: address
        target_address: 0x40
        value: 0x55
        cycles: 4
    - description: ABS
      code:
        - 0x8d
        - 0x3f
        - 0x60
      cpu:
        a: 0x55
      expected:
        read_from: address
        target_address: 0x603f
        value: 0x55
        cycles: 4
    - description: ABX
      code:
        - 0x9d
        - 0x3f
        - 0x60
      cpu:
        a: 0x55
        x: 0x01
      expected:
        read_from: address
        target_address: 0x6040
        value: 0x55
        cycles: 5
    - description: ABY
      code:
        - 0x99
        - 0x3f
        - 0x60
      cpu:
        a: 0x55
        y: 0x01
      expected:
        read_from: address
        target_address: 0x6040
        value: 0x55
        cycles: 5
    - description: IZX
      code:
        - 0x81
        - 0x3f
      cpu:
        a: 0x55
        x: 0x01
      init_memories:
        - start: 0x0040
          values:
            - 0xaa
            - 0x6a
      expected:
        read_from: address
        target_address: 0x6aaa
        value: 0x55
        cycles: 6
    - description: IZY
      code:
        - 0x91
        - 0x3f
      cpu:
        a: 0x55
        y: 0x01
      init_memories:
        - start: 0x003f
          values:
            - 0xaa
            - 0x6a
      expected:
        read_from: address
        target_address: 0x6aab
        value: 0x55
        cycles: 6
STX:
  cases:
    - description: ZP0
      code:
        - 0x86
        - 0x3f
      cpu:
        x: 0x55
      expected:
        read_from: address
        target_address: 0x3f
        value: 0x55
        cycles: 3
    - description: ZPY
      code:
        - 0x96
        - 0x3f
      cpu:
        x: 0x55
        y: 0x01
      expected:
        read_from: address
        target_address: 0x40
        value: 0x55
        cycles: 4
    - description: ABS
      code:
        - 0x8e
        - 0x3f
        - 0x60
      cpu:
        x: 0x55
      expected:
        read_from: address
        target_address: 0x603f
        value: 0x55
        cycles: 4
STY:
  cases:
    - description: ZP0
      code:
        - 0x84
        - 0x3f
      cpu:
        y: 0x55
      expected:
        read_from: address
        target_address: 0x3f
        value: 0x55
        cycles: 3
    - description: ZPX
      code:
        - 0x94
        - 0x3f
      cpu:
        y: 0x55
        x: 0x01
      expected:
        read_from: address
        target_address: 0x40
        value: 0x55
        cycles: 4
    - description: ABS
      code:
        - 0x8c
        - 0x3f
        - 0x60
      cpu:
        y: 0x55
      expected:
        read_from: address
        target_address: 0x603f
        value: 0x55
        cycles: 4
TXS:
  cases:
    - description: IMP
      code:
        - 0x9a
      cpu:
        x: 0x12
        sp: 0x00
      expected:
        read_from: sp
        value: 0x12
        cycles: 2
TSX:
  cases:
    - description: IMP
      code:
        - 0xba
      cpu:
        x: 0x12
        sp: 0xfe
      expected:
        read_from: x
        value: 0xfe
        cycles: 2
PHA:
  cases:
    - description: IMP
      code:
        - 0x48
      cpu:
        a: 0x12
        sp: 0xfe
      expected:
        read_from: address
        target_address: 0x01fe
        value: 0x12
        cycles: 3
    - description: Check SP
      code:
        - 0x48
      cpu:
        a: 0x12
        sp: 0xfe
      expected:
        read_from: sp
        value: 0xfd
PLA:
  cases:
    - description: IMP
      code:
        - 0x68
      cpu:
        a: 0x12
        sp: 0xfd
      init_memories:
        - start: 0x01fe
          values:
            - 0xaa
      expected:
        read_from: a
        value: 0xaa
        cycles: 4
    - description: Check Z
      code:
        - 0x68
      cpu:
        a: 0x12
        sp: 0xfd
      init_memories:
        - start: 0x01fe
          values:
            - 0x00
      expected:
        read_from: a
        value: 0x00
        check_flag:
          z: true
    - description: Check N
      code:
        - 0x68
      cpu:
        a: 0x12
        sp: 0xfd
      init_memories:
        - start: 0x01fe
          values:
            - 0x80
      expected:
        read_from: a
        value: 0x80
        heck_flag:
          n: true
    - description: Check SP
      code:
        - 0x68
      cpu:
        a: 0x12
        sp: 0xfd
      expected:
        read_from: sp
        value: 0xfe
PHP:
  cases:
    - description: IMP
      code:
        - 0x08
      cpu:
        p: 0x12
        sp: 0xfe
      expected:
        read_from: address
        target_address: 0x01fe
        value: 0x32
        cycles: 3
    - description: IMP
      code:
        - 0x08
      cpu:
        p: 0x12
        sp: 0xfe
      expected:
        read_from: address
        target_address: 0x01fe
        value: 0x32
        cycles: 3
PLP:
  cases:
    - description: IMP
      code:
        - 0x28
      cpu:
        p: 0x12
        sp: 0xfd
      init_memories:
        - start: 0x01fe
          values:
            - 0xaa
      expected:
        read_from: p
        value: 0xaa
        cycles: 4
JMP:
  cases:
    - description: ABS
      code:
        - 0x4c
        - 0xff
        - 0x81
      expected:
        read_from: pc
        value: 0x81ff
        cycles: 3
    - description: IND
      code:
        - 0x6c
        - 0x00
        - 0x81
      init_memories:
        - start: 0x8100
          values:
            - 0xaa
            - 0xaa
      expected:
        read_from: pc
        value: 0xaaaa
        cycles: 5
    - description: IND (check bug)
      code:
        - 0x6c
        - 0xff
        - 0x81
      init_memories:
        - start: 0x81ff
          values:
            - 0xaa
            - 0xbb
        - start: 0x8100
          values:
            - 0xaa
      expected:
        read_from: pc
        value: 0xaaaa
        cycles: 5
JSR:
  cases:
    - description: ABS
      code:
        - 0x20
        - 0xff
        - 0x81
      expected:
        read_from: pc
        value: 0x81ff
        cycles: 6
    - description: Save prev address (hi)
      code:
        - 0x20 # $8001
        - 0xff # $8002
        - 0x81 # $8003
      cpu:
        sp: 0xfd
      expected:
        read_from: address
        target_address: 0x01fd
        value: 0x80
        cycles: 6
    - description: Save prev address (lo)
      code:
        - 0x20 # $8001
        - 0xff # $8002
        - 0x81 # $8003
      cpu:
        sp: 0xfd
      expected:
        read_from: address
        target_address: 0x01fc
        value: 0x03
        cycles: 6
RTS:
  cases:
    - description: IMP
      code:
        - 0x60
      cpu:
        sp: 0xfb
      init_memories:
        - start: 0x01fc
          values:
            - 0xaa
            - 0xbb
      expected:
        read_from: pc
        value: 0xbbab
        cycles: 6
